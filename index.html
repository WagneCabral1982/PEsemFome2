<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PE sem FOME - Portal de Assist√™ncia Alimentar</title>
  <style>
    :root {
      --primary: #007BFF;
      --secondary: #6c757d;
      --success: #28a745;
      --danger: #dc3545;
      --warning: #ffc107;
      --light: #f8f9fa;
      --dark: #343a40;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f0f2f5;
      line-height: 1.6;
      color: #333;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    header {
      background: linear-gradient(135deg, #007BFF 0%, #0056b3 100%);
      color: white;
      padding: 30px 25px;
      text-align: center;
    }
    
    header img {
      width: 140px;
      height: auto;
      margin-bottom: 20px;
    }
    
    header h1 {
      font-size: 32px;
      margin: 10px 0 15px 0;
      font-weight: 700;
    }
    
    .welcome-text {
      font-size: 18px;
      opacity: 0.95;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.6;
    }
    
    .main-content {
      padding: 30px 25px;
    }
    
    .section-title {
      text-align: center;
      color: #007BFF;
      margin-bottom: 30px;
      font-size: 24px;
      font-weight: 600;
    }
    
    .cards-container {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      justify-content: center;
      margin-bottom: 40px;
    }
    
    .card {
      flex: 1;
      min-width: 300px;
      max-width: 400px;
      background: white;
      border-radius: 12px;
      padding: 30px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      border: 1px solid #eaeaea;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.12);
    }
    
    .card img {
      width: 70px;
      height: 70px;
      margin-bottom: 20px;
    }
    
    .card h3 {
      color: #007BFF;
      margin-bottom: 15px;
      font-size: 22px;
    }
    
    .card p {
      color: #666;
      margin-bottom: 25px;
      font-size: 16px;
      line-height: 1.5;
    }
    
    .card-button {
      padding: 12px 25px;
      background-color: var(--primary);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .card-button:hover {
      background-color: #0069d9;
    }
    
    .help-section {
      text-align: center;
      padding: 20px;
      border-top: 1px solid #eaeaea;
      margin-top: 20px;
    }
    
    .help-link {
      color: #007BFF;
      text-decoration: none;
      font-weight: 600;
      font-size: 16px;
      transition: color 0.2s;
    }
    
    .help-link:hover {
      color: #0056b3;
      text-decoration: underline;
    }
    
    /* Estilos para as demais se√ß√µes */
    .form-section {
      padding: 25px;
    }
    
    .form-section h2 {
      color: #007BFF;
      margin-bottom: 20px;
      font-size: 22px;
      border-bottom: 2px solid #eaeaea;
      padding-bottom: 10px;
    }
    
    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .form-group {
      flex: 1;
      min-width: 250px;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #495057;
    }
    
    label.required:after {
      content: " *";
      color: #dc3545;
    }
    
    input, select {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ced4da;
      border-radius: 6px;
      font-size: 16px;
      transition: border-color 0.2s;
    }
    
    input:focus, select:focus {
      border-color: #007BFF;
      outline: none;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
    }
    
    .checkbox-group {
      display: flex;
      gap: 15px;
      align-items: center;
      margin-top: 10px;
    }
    
    .checkbox-group label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: normal;
      cursor: pointer;
    }
    
    .checkbox-group input[type="checkbox"] {
      width: 18px;
      height: 18px;
    }
    
    .location-buttons {
      display: flex;
      gap: 12px;
      margin: 15px 0;
    }
    
    .button {
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .button-blue {
      background-color: var(--primary);
      color: white;
    }
    
    .button-blue:hover {
      background-color: #0069d9;
    }
    
    .button-gray {
      background-color: var(--secondary);
      color: white;
    }
    
    .button-gray:hover {
      background-color: #5a6268;
    }
    
    .button-red {
      background-color: var(--danger);
      color: white;
    }
    
    .button-red:hover {
      background-color: #c82333;
    }
    
    .button-green {
      background-color: var(--success);
      color: white;
    }
    
    .button-green:hover {
      background-color: #218838;
    }
    
    .button-group {
      display: flex;
      gap: 15px;
      margin-top: 25px;
    }
    
    .optional-section {
      background-color: #f8f9fa;
      border-left: 4px solid #007BFF;
      padding: 15px;
      margin: 25px 0;
      border-radius: 4px;
    }
    
    .optional-section h3 {
      color: #007BFF;
      margin-bottom: 12px;
      font-size: 18px;
    }
    
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(0,0,0,.3);
      border-radius: 50%;
      border-top-color: #007BFF;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .hidden {
      display: none !important;
    }
    
    .results-section {
      padding: 25px;
    }
    
    .results-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #eaeaea;
    }
    
    .results-title {
      color: #007BFF;
      font-size: 22px;
    }
    
    .service-card {
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      border-left: 5px solid;
    }
    
    .cras-card { border-left-color: #28a745; }
    .creas-card { border-left-color: #ffc107; }
    .cozinha-card { border-left-color: #007bff; }
    .centro-pop-card { border-left-color: #dc3545; }
    .posto-card { border-left-color: #6f42c1; }
    
    .service-card h3 {
      color: #212529;
      margin-bottom: 12px;
      font-size: 18px;
    }
    
    .service-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    
    .service-detail {
      display: flex;
      flex-direction: column;
    }
    
    .detail-label {
      font-size: 14px;
      color: #6c757d;
      margin-bottom: 4px;
    }
    
    .detail-value {
      font-size: 16px;
      color: #212529;
      font-weight: 500;
    }
    
    .service-definition {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 6px;
      margin-top: 15px;
      font-size: 14px;
      color: #6c757d;
      border-left: 3px solid #6c757d;
    }
    
    .no-results {
      text-align: center;
      padding: 40px 20px;
      color: #6c757d;
    }
    
    .no-results img {
      width: 80px;
      margin-bottom: 20px;
      opacity: 0.7;
    }
    
    .stats-prompt {
      background-color: #e8f4fd;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 25px;
      border-left: 4px solid #007BFF;
    }
    
    .stats-prompt p {
      margin-bottom: 15px;
      color: #0056b3;
      font-size: 16px;
    }
    
    .stats-form-section {
      padding: 25px;
    }
    
    .stats-form-section h2 {
      color: #007BFF;
      margin-bottom: 20px;
      font-size: 22px;
      border-bottom: 2px solid #eaeaea;
      padding-bottom: 10px;
    }
    
    .form-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 25px;
      padding-top: 15px;
      border-top: 1px solid #eaeaea;
    }
    
    .success-message {
      text-align: center;
      padding: 40px 20px;
      color: #155724;
      background-color: #d4edda;
      border-radius: 8px;
      margin: 20px 0;
    }
    
    .success-message h3 {
      margin-bottom: 15px;
      color: #155724;
    }
    
    @media (max-width: 768px) {
      .cards-container {
        flex-direction: column;
        align-items: center;
      }
      
      .card {
        min-width: 100%;
      }
      
      header h1 {
        font-size: 28px;
      }
      
      .welcome-text {
        font-size: 16px;
      }
      
      .form-row {
        flex-direction: column;
        gap: 15px;
      }
      
      .button-group {
        flex-direction: column;
      }
      
      .location-buttons {
        flex-direction: column;
      }
      
      .form-navigation {
        flex-direction: column;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Tela Inicial (Home) -->
    <section id="home">
      <header>
        <img src="https://raw.githubusercontent.com/WagneCabral1982/PEsemFome2/main/Logotipo%20PE_sem_Fome.png" alt="Logotipo PE sem Fome">
        <h1>Bem-vindo ao PE Sem Fome</h1>
        <p class="welcome-text">Neste portal voc√™ pode consultar servi√ßos de assist√™ncia alimentar e prote√ß√£o social que podem direcionar voc√™ ou algu√©m em situa√ß√£o de inseguran√ßa alimentar e nutricional para servi√ßos que ajudem a superar essa situa√ß√£o.</p>
      </header>

      <div class="main-content">
        <h2 class="section-title">Selecione para quem a consulta est√° destinada:</h2>
        
        <div class="cards-container">
          <div class="card" onclick="selecionarOpcao('mim')">
            <img src="https://img.icons8.com/ios-filled/100/007BFF/user.png" alt="√çcone de pessoa">
            <h3>Para mim</h3>
            <p>Encontre servi√ßos de assist√™ncia alimentar e prote√ß√£o social perto de voc√™.</p>
            <button class="card-button">Selecionar</button>
          </div>
          
          <div class="card" onclick="selecionarOpcao('outra-pessoa')">
            <img src="https://img.icons8.com/ios-filled/100/007BFF/group-foreground-selected.png" alt="√çcone de grupo de pessoas">
            <h3>Outra pessoa</h3>
            <p>Encontre servi√ßos de assist√™ncia alimentar e prote√ß√£o social para ajudar algu√©m.</p>
            <button class="card-button">Selecionar</button>
          </div>
        </div>
        
        <div class="help-section">
          <a href="#" class="help-link">Precisa de ajuda? Fale conosco</a>
        </div>
      </div>
    </section>

    <!-- Se√ß√£o de Consulta -->
    <section id="consulta" class="form-section hidden">
      <h2>Consulta de Equipamentos</h2>
      
      <div class="form-row">
        <div class="form-group">
          <label for="municipio" class="required">Munic√≠pio</label>
          <select id="municipio" required>
            <option value="">Selecione um munic√≠pio</option>
            <option value="recife">Recife</option>
            <option value="olinda">Olinda</option>
            <option value="jaboatao">Jaboat√£o dos Guararapes</option>
            <option value="paulista">Paulista</option>
            <option value="caruaru">Caruaru</option>
            <option value="petrolina">Petrolina</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="bairro" class="required">Bairro</label>
          <select id="bairro" required disabled>
            <option value="">Primeiro selecione um munic√≠pio</option>
          </select>
        </div>
      </div>
      
      <div class="location-buttons">
        <button id="geolocation-btn" class="button button-blue">
          <span>üìç</span> Usar minha localiza√ß√£o
        </button>
        <button id="clear-location-btn" class="button button-gray">
          <span>üîÑ</span> Limpar localiza√ß√£o
        </button>
      </div>
      
      <div id="loading-geo" class="hidden">
        <span class="loading"></span> Obtendo localiza√ß√£o...
      </div>
      
      <div class="form-group">
        <label class="required">Situa√ß√£o de Rua?</label>
        <div class="checkbox-group">
          <label><input type="radio" name="situacaoRua" value="sim" required> Sim</label>
          <label><input type="radio" name="situacaoRua" value="nao" checked> N√£o</label>
        </div>
      </div>
      
      <div class="optional-section">
        <h3>Consulta opcional ao Cad√önico</h3>
        <div class="form-row">
          <div class="form-group">
            <label for="cpf">CPF</label>
            <input type="text" id="cpf" placeholder="Digite o CPF (apenas n√∫meros)" maxlength="11">
          </div>
          
          <div class="form-group">
            <label for="nis">NIS</label>
            <input type="text" id="nis" placeholder="Digite o NIS (apenas n√∫meros)" maxlength="11">
          </div>
        </div>
      </div>
      
      <div class="button-group">
        <button id="consultar-btn" class="button button-blue">Consultar Equipamentos</button>
        <button id="voltar-home" class="button button-gray">Voltar</button>
      </div>
    </section>
    
    <!-- Se√ß√£o de Resultados -->
    <section id="resultados" class="results-section hidden">
      <div class="results-header">
        <h2 class="results-title">Resultados da Consulta</h2>
        <button id="voltar-consulta" class="button button-gray">Voltar</button>
      </div>
      
      <div class="stats-prompt">
        <p>Al√©m de visualizar os equipamentos dispon√≠veis, voc√™ pode nos ajudar a melhorar as pol√≠ticas p√∫blicas de combate √† fome preenchendo algumas informa√ß√µes adicionais.</p>
        <button id="preencher-formulario-btn" class="button button-green">Preencher Formul√°rio</button>
      </div>
      
      <div id="cadunico-result"></div>
      <div id="equipamentos-list"></div>
    </section>
    
    <!-- Formul√°rio Estat√≠stico -->
    <section id="formulario-estatistico" class="stats-form-section hidden">
      <h2>Dados para Fins Estat√≠sticos</h2>
      
      <form id="formEstatistico">
        <div class="form-row">
          <div class="form-group">
            <label for="nomeCompleto" class="required">Nome completo</label>
            <input type="text" id="nomeCompleto" required>
          </div>
          
          <div class="form-group">
            <label for="nomeSocial">Nome social</label>
            <input type="text" id="nomeSocial">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="genero" class="required">G√™nero</label>
            <select id="genero" required>
              <option value="">Selecione</option>
              <option value="masculino">Masculino</option>
              <option value="feminino">Feminino</option>
              <option value="nao-binario">N√£o-bin√°rio</option>
              <option value="outro">Outro</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="dataNascimento" class="required">Data de nascimento</label>
            <input type="date" id="dataNascimento" required>
          </div>
        </div>
        
        <div class="form-group">
          <label class="required">A pessoa √© brasileira?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="brasileiro" value="sim" required> Sim</label>
            <label><input type="radio" name="brasileiro" value="nao"> N√£o</label>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="municipioEstatistico" class="required">Munic√≠pio</label>
            <input type="text" id="municipioEstatistico" readonly required>
          </div>
          
          <div class="form-group">
            <label for="endereco" class="required">Endere√ßo</label>
            <input type="text" id="endereco" required>
          </div>
        </div>
        
        <div class="form-navigation">
          <button type="button" id="voltar-resultados" class="button button-gray">Voltar</button>
          <div>
            <button type="button" id="fechar-formulario" class="button button-red">Fechar</button>
            <button type="submit" class="button button-green">Concluir</button>
          </div>
        </div>
      </form>
    </section>
    
    <!-- Confirma√ß√£o de Envio -->
    <section id="confirmacao-envio" class="results-section hidden">
      <div class="success-message">
        <h3>Obrigado pela contribui√ß√£o!</h3>
        <p>Seus dados foram registrados com sucesso. Obrigado por contribuir para o fortalecimento das pol√≠ticas p√∫blicas.</p>
        <button id="voltar-pos-envio" class="button button-blue" style="margin-top: 20px;">Voltar aos Resultados</button>
      </div>
    </section>
  </div>

  <script>
    // Dados de exemplo para bairros por munic√≠pio
    const bairrosPorMunicipio = {
      'recife': ['Boa Viagem', 'Boa Vista', 'Casa Amarela', 'Cordeiro', 'Derby', 'Espinheiro', 'Gra√ßas', 'Ilha do Leite', 'Imbiribeira', 'Parnamirim', 'Pina', 'Recife Antigo', 'Santo Amaro', 'S√£o Jos√©', 'V√°rzea'],
      'olinda': ['Bairro Novo', 'Carmo', 'Jardim Brasil', 'Peixinhos', 'Rio Doce', 'Salgadinho'],
      'jaboatao': ['Barra de Jangada', 'Candeias', 'Cavaleiro', 'Jardim Piedade', 'Prazeres', 'Sucupira'],
      'paulista': ['Arthur Lundgren I', 'Jardim Paulista', 'Maranguape I', 'Paratibe', 'Pau Amarelo'],
      'caruaru': ['Centro', 'Divin√≥polis', 'Indian√≥polis', 'Jardim Panor√¢mico', 'Rendeiras', 'Salgado'],
      'petrolina': ['Centro', 'Jardim Amazonas', 'Jardim S√£o Paulo', 'Km-2', 'Palhinhas', 'Rio Corrente']
    };

    // Dados de exemplo para equipamentos
    const equipamentos = {
      'centro-pop': {
        tipo: 'Centro POP',
        nome: 'Centro POP - Centro',
        endereco: 'Rua da Aurora, 123',
        pontoRef: 'Pr√≥ximo ao Parque da Jaqueira',
        contato: '(81) 3333-4444',
        horario: '08:00 √†s 17:00',
        codIbge: '2611606'
      },
      'creas': {
        tipo: 'CREAS',
        nome: 'CREAS - Afogados',
        endereco: 'Rua 21 de Abril, 1092',
        pontoRef: 'Pr√≥ximo ao Mercado P√∫blico de Afogados',
        contato: '(81) 3355-3671',
        horario: '08:00 √†s 17:00',
        codIbge: '2611606'
      },
      'posto-cadunico': {
        tipo: 'Posto de Atendimento do Cad√önico',
        nome: 'Posto de Atendimento - Boa Vista',
        endereco: 'Av. Conde da Boa Vista, 123',
        pontoRef: 'Pr√≥ximo √† Pra√ßa da Maconha',
        contato: '(81) 3222-1234',
        horario: '08:00 √†s 17:00',
        codIbge: '2611606'
      },
      'cozinha-comunitaria': {
        tipo: 'Cozinha Comunit√°ria',
        nome: 'Cozinha Comunit√°ria - Gurup√©',
        endereco: 'Rua Gurup√©, 253',
        representante: 'Nivea Gouveia',
        contato: '(81) 99362-9916',
        horario: '07:00 √†s 14:00',
        codIbge: '2611606'
      },
      'cras': {
        tipo: 'CRAS',
        nome: 'CRAS - Bongi',
        endereco: 'Av. Gen San Martin, 1083 - Bongi',
        pontoRef: 'Pr√≥ximo ao Compaz Ariano Suassuna',
        contato: '(81) 3225-9440',
        horario: '08:00 √†s 17:00',
        codIbge: '2611606'
      }
    };

    // Defini√ß√µes dos servi√ßos
    const definicoesServicos = {
      'Centro POP': 'Centro de Refer√™ncia Especializado para Popula√ß√£o em Situa√ß√£o de Rua oferece atendimento especializado e individualizado para pessoas em situa√ß√£o de rua.',
      'CREAS': 'Centro de Refer√™ncia Especializado de Assist√™ncia Social atende fam√≠lias e indiv√≠duos com direitos violados, oferecendo apoio e orienta√ß√£o especializada.',
      'Posto de Atendimento do Cad√önico': 'Unidade respons√°vel pelo cadastramento e atualiza√ß√£o de informa√ß√µes no Cadastro √önico para programas sociais do governo.',
      'Cozinha Comunit√°ria': 'Espa√ßo que oferece refei√ß√µes prontas e saud√°veis, gratuitas ou a pre√ßos acess√≠veis, para comunidades em situa√ß√£o de vulnerabilidade social.',
      'CRAS': 'Centro de Refer√™ncia de Assist√™ncia Social √© a porta de entrada para os servi√ßos de prote√ß√£o social b√°sica do SUAS.'
    };

    // Vari√°veis para armazenar dados entre se√ß√µes
    let municipioConsulta = '';
    let bairroConsulta = '';
    let situacaoRuaConsulta = '';

    document.addEventListener('DOMContentLoaded', function() {
      // Elementos da DOM
      const homeSection = document.getElementById('home');
      const consultaSection = document.getElementById('consulta');
      const resultadosSection = document.getElementById('resultados');
      const formularioEstatisticoSection = document.getElementById('formulario-estatistico');
      const confirmacaoEnvioSection = document.getElementById('confirmacao-envio');
      
      const municipioSelect = document.getElementById('municipio');
      const bairroSelect = document.getElementById('bairro');
      const geolocationBtn = document.getElementById('geolocation-btn');
      const clearLocationBtn = document.getElementById('clear-location-btn');
      const loadingGeo = document.getElementById('loading-geo');
      const consultarBtn = document.getElementById('consultar-btn');
      const voltarHomeBtn = document.getElementById('voltar-home');
      const voltarConsultaBtn = document.getElementById('voltar-consulta');
      const preencherFormularioBtn = document.getElementById('preencher-formulario-btn');
      const voltarResultadosBtn = document.getElementById('voltar-resultados');
      const fecharFormularioBtn = document.getElementById('fechar-formulario');
      const voltarPosEnvioBtn = document.getElementById('voltar-pos-envio');
      const formEstatistico = document.getElementById('formEstatistico');
      const municipioEstatistico = document.getElementById('municipioEstatistico');
      
      const equipamentosList = document.getElementById('equipamentos-list');
      const cadunicoResult = document.getElementById('cadunico-result');
      
      // Preencher bairros quando selecionar munic√≠pio
      municipioSelect.addEventListener('change', function() {
        const municipioValue = this.value;
        
        // Limpar select de bairro
        bairroSelect.innerHTML = '';
        
        if (municipioValue && bairrosPorMunicipio[municipioValue]) {
          bairroSelect.disabled = false;
          
          // Adicionar op√ß√£o padr√£o
          const defaultOption = document.createElement('option');
          defaultOption.value = '';
          defaultOption.textContent = 'Selecione um bairro';
          bairroSelect.appendChild(defaultOption);
          
          // Adicionar bairros do munic√≠pio selecionado
          bairrosPorMunicipio[municipioValue].forEach(bairro => {
            const option = document.createElement('option');
            option.value = bairro.toLowerCase().replace(/\s+/g, '-');
            option.textContent = bairro;
            bairroSelect.appendChild(option);
          });
        } else {
          bairroSelect.disabled = true;
          const option = document.createElement('option');
          option.value = '';
          option.textContent = 'Primeiro selecione um munic√≠pio';
          bairroSelect.appendChild(option);
        }
      });
      
      // Selecionar op√ß√£o na tela inicial
      window.selecionarOpcao = function(opcao) {
        homeSection.classList.add('hidden');
        consultaSection.classList.remove('hidden');
      };
      
      // Voltar para a tela inicial
      voltarHomeBtn.addEventListener('click', function() {
        consultaSection.classList.add('hidden');
        homeSection.classList.remove('hidden');
      });
      
      // Geolocaliza√ß√£o
      geolocationBtn.addEventListener('click', function() {
        if (!navigator.geolocation) {
          alert('Geolocaliza√ß√£o n√£o √© suportada pelo seu navegador');
          return;
        }
        
        loadingGeo.classList.remove('hidden');
        
        function success(position) {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;
          
          // Simula√ß√£o de obten√ß√£o de munic√≠pio e bairro a partir das coordenadas
          setTimeout(() => {
            // Simulando que estamos no Recife, bairro Boa Viagem
            municipioSelect.value = 'recife';
            
            // Disparar evento change para carregar os bairros
            const event = new Event('change');
            municipioSelect.dispatchEvent(event);
            
            // Aguardar um pouco para o carregamento dos bairros
            setTimeout(() => {
              bairroSelect.value = 'boa-viagem';
              loadingGeo.classList.add('hidden');
              alert('Localiza√ß√£o obtida com sucesso! Munic√≠pio e bairro preenchidos automaticamente.');
            }, 500);
          }, 1500);
        }
        
        function error() {
          loadingGeo.classList.add('hidden');
          alert('N√£o foi poss√≠vel obter sua localiza√ß√£o. Por favor, preencha manualmente.');
        }
        
        navigator.geolocation.getCurrentPosition(success, error);
      });
      
      // Limpar localiza√ß√£o
      clearLocationBtn.addEventListener('click', function() {
        municipioSelect.value = '';
        bairroSelect.innerHTML = '';
        bairroSelect.disabled = true;
        const option = document.createElement('option');
        option.value = '';
        option.textContent = 'Primeiro selecione um munic√≠pio';
        bairroSelect.appendChild(option);
        
        // Desmarcar situa√ß√£o de rua
        document.querySelector('input[name="situacaoRua"][value="nao"]').checked = true;
        
        // Limpar campos opcionais
        document.getElementById('cpf').value = '';
        document.getElementById('nis').value = '';
      });
      
      // Consultar equipamentos
      consultarBtn.addEventListener('click', function() {
        // Validar campos obrigat√≥rios
        const municipio = municipioSelect.value;
        const bairro = bairroSelect.value;
        const situacaoRua = document.querySelector('input[name="situacaoRua"]:checked').value;
        
        if (!municipio || !bairro) {
          alert('Por favor, preencha todos os campos obrigat√≥rios (munic√≠pio e bairro).');
          return;
        }
        
        // Salvar dados para uso posterior no formul√°rio estat√≠stico
        municipioConsulta = municipioSelect.options[municipioSelect.selectedIndex].text;
        bairroConsulta = bairroSelect.options[bairroSelect.selectedIndex].text;
        situacaoRuaConsulta = situacaoRua;
        
        // Obter valores opcionais
        const cpf = document.getElementById('cpf').value;
        const nis = document.getElementById('nis').value;
        
        // Verificar Cad√önico se CPF ou NIS foram informados
        if (cpf || nis) {
          consultarCadunico(cpf, nis);
        } else {
          cadunicoResult.innerHTML = '';
        }
        
        // Exibir equipamentos com base na situa√ß√£o de rua
        exibirEquipamentos(situacaoRua);
        
        // Mostrar se√ß√£o de resultados
        consultaSection.classList.add('hidden');
        resultadosSection.classList.remove('hidden');
      });
      
      // Voltar para a consulta
      voltarConsultaBtn.addEventListener('click', function() {
        resultadosSection.classList.add('hidden');
        consultaSection.classList.remove('hidden');
      });
      
      // Abrir formul√°rio estat√≠stico
      preencherFormularioBtn.addEventListener('click', function() {
        // Pr√©-preencher o munic√≠pio com base na consulta anterior
        municipioEstatistico.value = municipioConsulta;
        
        // Mostrar se√ß√£o do formul√°rio estat√≠stico
        resultadosSection.classList.add('hidden');
        formularioEstatisticoSection.classList.remove('hidden');
      });
      
      // Voltar para os resultados a partir do formul√°rio
      voltarResultadosBtn.addEventListener('click', function() {
        formularioEstatisticoSection.classList.add('hidden');
        resultadosSection.classList.remove('hidden');
      });
      
      // Fechar formul√°rio
      fecharFormularioBtn.addEventListener('click', function() {
        formularioEstatisticoSection.classList.add('hidden');
        homeSection.classList.remove('hidden');
      });
      
      // Voltar para os resultados ap√≥s envio
      voltarPosEnvioBtn.addEventListener('click', function() {
        confirmacaoEnvioSection.classList.add('hidden');
        resultadosSection.classList.remove('hidden');
      });
      
      // Enviar formul√°rio estat√≠stico
      formEstatistico.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Coletar dados do formul√°rio
        const formData = {
          nomeCompleto: document.getElementById('nomeCompleto').value,
          nomeSocial: document.getElementById('nomeSocial').value,
          genero: document.getElementById('genero').value,
          dataNascimento: document.getElementById('dataNascimento').value,
          brasileiro: document.querySelector('input[name="brasileiro"]:checked').value,
          municipio: municipioEstatistico.value,
          endereco: document.getElementById('endereco').value,
          bairroConsulta: bairroConsulta,
          situacaoRuaConsulta: situacaoRuaConsulta,
          dataEnvio: new Date().toISOString()
        };
        
        // Simular envio para o servidor
        console.log('Dados enviados para estat√≠sticas:', formData);
        
        // Limpar formul√°rio
        formEstatistico.reset();
        
        // Mostrar confirma√ß√£o de envio
        formularioEstatisticoSection.classList.add('hidden');
        confirmacaoEnvioSection.classList.remove('hidden');
      });
      
      // Fun√ß√£o para consultar Cad√önico (simula√ß√£o)
      function consultarCadunico(cpf, nis) {
        // Simula√ß√£o de consulta √† API Cad√önico
        const encontrado = Math.random() > 0.5; // Simula 50% de chance de encontrar
        
        if (encontrado) {
          cadunicoResult.innerHTML = `
            <div class="service-card" style="border-left-color: var(--success);">
              <h3>Pessoa localizada no Cad√önico</h3>
              <p>Procure Posto de Atendimento, CREAS ou Cozinha Comunit√°ria para mais informa√ß√µes.</p>
            </div>
          `;
        } else {
          cadunicoResult.innerHTML = `
            <div class="service-card" style="border-left-color: var(--warning);">
              <h3>Pessoa n√£o localizada no Cad√önico</h3>
              <p>Voc√™ pode se dirigir a um dos equipamentos listados abaixo para realizar seu cadastro.</p>
            </div>
          `;
        }
      }
      
      // Fun√ß√£o para exibir equipamentos com base na situa√ß√£o de rua
      function exibirEquipamentos(situacaoRua) {
        equipamentosList.innerHTML = '';
        
        let equipamentosExibir = [];
        
        if (situacaoRua === 'sim') {
          // Ordem espec√≠fica para situa√ß√£o de rua = sim
          equipamentosExibir = [
            equipamentos['centro-pop'],
            equipamentos['creas'],
            equipamentos['posto-cadunico'],
            equipamentos['cozinha-comunitaria']
          ];
        } else {
          // Ordem espec√≠fica para situa√ß√£o de rua = n√£o
          equipamentosExibir = [
            equipamentos['posto-cadunico'],
            equipamentos['creas'],
            equipamentos['cozinha-comunitaria'],
            equipamentos['cras']
          ];
        }
        
        if (equipamentosExibir.length === 0) {
          equipamentosList.innerHTML = `
            <div class="no-results">
              <img src="https://img.icons8.com/ios/100/000000/no-image.png" alt="Nenhum resultado">
              <h3>Nenhum equipamento encontrado</h3>
              <p>N√£o foram encontrados equipamentos para os crit√©rios informados.</p>
            </div>
          `;
          return;
        }
        
        const definicoesMostradas = new Set();
        
        equipamentosExibir.forEach(equipamento => {
          const card = document.createElement('div');
          card.className = `service-card ${equipamento.tipo.toLowerCase().replace(/\s+/g, '-')}-card`;
          
          let detalhes = '';
          
          if (equipamento.tipo === 'Cozinha Comunit√°ria') {
            detalhes = `
              <div class="service-details">
                <div class="service-detail">
                  <span class="detail-label">Representante</span>
                  <span class="detail-value">${equipamento.representante}</span>
                </div>
                <div class="service-detail">
                  <span class="detail-label">Endere√ßo</span>
                  <span class="detail-value">${equipamento.endereco}</span>
                </div>
                <div class="service-detail">
                  <span class="detail-label">Telefone</span>
                  <span class="detail-value">${equipamento.contato}</span>
                </div>
                <div class="service-detail">
                  <span class="detail-label">Hor√°rio</span>
                  <span class="detail-value">${equipamento.horario}</span>
                </div>
              </div>
            `;
          } else {
            detalhes = `
              <div class="service-details">
                <div class="service-detail">
                  <span class="detail-label">Endere√ßo</span>
                  <span class="detail-value">${equipamento.endereco}</span>
                </div>
                <div class="service-detail">
                  <span class="detail-label">Ponto de Refer√™ncia</span>
                  <span class="detail-value">${equipamento.pontoRef}</span>
                </div>
                <div class="service-detail">
                  <span class="detail-label">Contato</span>
                  <span class="detail-value">${equipamento.contato}</span>
                </div>
                <div class="service-detail">
                  <span class="detail-label">Hor√°rio</span>
                  <span class="detail-value">${equipamento.horario}</span>
                </div>
              </div>
            `;
          }
          
          card.innerHTML = `
            <h3>${equipamento.nome}</h3>
            ${detalhes}
            ${getDefinicaoServicoUnicaVez(equipamento.tipo, definicoesMostradas)}
          `;
          
          equipamentosList.appendChild(card);
        });
      }
      
      // Fun√ß√£o para obter defini√ß√£o do servi√ßo (apenas uma vez per tipo)
      function getDefinicaoServicoUnicaVez(tipo, definicoesMostradas) {
        if (definicoesMostradas.has(tipo)) return '';
        
        if (definicoesServicos[tipo]) {
          definicoesMostradas.add(tipo);
          return `<div class="service-definition">${definicoesServicos[tipo]}</div>`;
        }
        return '';
      }
    });
  </script>
</body>
</html>

