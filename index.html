<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PE sem FOME</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f4f4f4;
      line-height: 1.6;
    }
    .card-container {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    .title-area {
      text-align: center;
      margin-bottom: 20px;
    }
    .title-area img {
      width: 120px;
      height: auto;
    }
    .title-area h1 {
      margin-top: 10px;
      font-size: 24px;
      color: #333;
    }
    .card-buttons {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .card {
      flex: 1;
      min-width: 160px;
      max-width: 200px;
      padding: 20px;
      background: #fff;
      border: 1px solid #ddd;
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .card img {
      width: 40px;
      height: 40px;
      margin-bottom: 10px;
    }
    .card:hover {
      background: #eef;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    .hidden {
      display: none !important;
    }
    .form-section, .mensagem-section {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      max-width: 600px;
      margin: 20px auto;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    fieldset {
      border: 1px solid #ddd;
      border-radius: 5px;
      padding: 15px;
      margin-bottom: 15px;
    }
    legend {
      padding: 0 10px;
      font-weight: bold;
      color: #333;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: #555;
    }
    label.required:after {
      content: " *";
      color: red;
    }
    input, select, button, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    .button-blue {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
      flex: 1;
      border-radius: 4px;
      font-weight: bold;
    }
    .button-red {
      background-color: #dc3545;
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
      flex: 1;
      border-radius: 4px;
      font-weight: bold;
    }
    .radio-group {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-top: 10px;
    }
    .radio-group label {
      font-weight: normal;
    }
    .modal {
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-content {
      background-color: #fefefe;
      padding: 25px;
      border-radius: 10px;
      width: 90%;
      max-width: 550px;
    }
    .modal-content h2 {
      font-weight: bold;
      font-size: 18px;
      text-align: center;
    }
     .modal-buttons-docs {
      display: flex;
      gap: 15px;
      margin: 20px 0;
      justify-content: center;
    }
    .aceite-termos-popup {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 25px 0;
    }
    .warning-block {
      background-color: #fff3cd;
      border: 1px solid #ffeeba;
      border-radius: 5px;
      padding: 15px;
      margin: 20px 0;
    }
    .service-card {
      background-color: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 5px;
      padding: 15px;
      margin-bottom: 15px;
      padding-left: 20px;
    }
    .service-card h4 {
      margin-top: 0;
      font-size: 1.1em;
      color: #333;
    }
    .service-card ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
      font-size: 0.95em;
      color: #555;
    }
    .service-card ul li {
      margin-bottom: 5px;
    }
    .service-definition {
      font-size: 0.9em;
      font-style: italic;
      color: #6c757d;
      background-color: #f8f9fa;
      padding: 10px;
      border-radius: 5px;
      margin: -5px 0 15px 0;
    }
    .cras-card { border-left: 5px solid #28a745; }
    .creas-card { border-left: 5px solid #ffc107; }
    .cozinha-card { border-left: 5px solid #007bff; }
  </style>
</head>
<body>

  <header class="title-area">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/59/Bandeira_de_Pernambuco.svg/640px-Bandeira_de_Pernambuco.svg.png" alt="Bandeira de Pernambuco">
    <h1>PE sem FOME</h1>
  </header>

  <main>
    <section class="card-container">
      <div class="card-buttons">
        <button class="card" onclick="selecionarOpcao('mim')" aria-label="Ajuda para mim">
          <img src="https://img.icons8.com/ios-filled/50/user.png" alt="√çcone de pessoa">
          Para mim
        </button>
        <button class="card" onclick="selecionarOpcao('alguem')" aria-label="Ajudar algu√©m">
          <img src="https://img.icons8.com/ios-filled/50/group-foreground-selected.png" alt="√çcone de grupo de pessoas">
          Ajudar algu√©m
        </button>
      </div>
    </section>

    <div id="avisoPrivacidadeModal" class="modal hidden">
      <div class="modal-content">
        <h2>AVISO DE PRIVACIDADE</h2>
        <p id="modalPrivacyText">A SECRETARIA DE ASSIST√äNCIA SOCIAL, COMBATE √Ä FOME E POL√çTICAS SOBRE DROGAS (SAS) de Pernambuco, no √¢mbito do programa "PE sem Fome", est√° adotando todas as medidas de seguran√ßa necess√°rias...</p>
        <button id="readAloudBtn" class="button-blue" style="background-color: #6c757d; margin-top: 10px;">üîä Ouvir o texto</button>
        <div class="modal-buttons-docs">
          <button type="button" class="button-blue" onclick="abrirPdf('https://github.com/WagneCabral1982/PEsemFome2/blob/main/LGPD_POL%C3%8DTICA%20DE%20PRIVACIDADE.pdf')">Pol√≠tica de Privacidade</button>
          <button type="button" class="button-blue" onclick="abrirPdf('https://github.com/WagneCabral1982/PEsemFome2/blob/main/LGPD_TERMO%20DE%20USO.pdf')">Termo de Uso</button>
        </div>
        <div class="button-group">
          <button type="button" class="button-blue" onclick="mostrarPopupConfirmacao()">Continuar &rarr;</button>
          <button type="button" class="button-red" onclick="cancelarFormulario()">Sair</button>
        </div>
      </div>
    </div>

    <div id="confirmacaoModal" class="modal hidden">
      <div class="modal-content">
        <p>Conforme os termos acima li e estou ciente.</p>
        <div class="aceite-termos-popup">
          <input type="checkbox" id="checkboxConfirmacao">
          <label for="checkboxConfirmacao">Li e concordo com os termos acima</label>
        </div>
        <div class="button-group">
          <button type="button" class="button-blue" onclick="prosseguirParaConsulta()">OK</button>
          <button type="button" class="button-red" onclick="voltarParaAvisoPrivacidade()">Cancelar</button>
        </div>
      </div>
    </div>

    <section id="consulta" class="form-section hidden">
      <h2>Consulta Cad√önico</h2>
      <label for="cpf">CPF:</label>
      <input type="text" id="cpf" placeholder="Digite o CPF (apenas n√∫meros)" maxlength="11">
      <label for="nis">NIS:</label>
      <input type="text" id="nis" placeholder="Digite o NIS (apenas n√∫meros)" maxlength="11">
      <div class="button-group">
        <button type="button" class="button-blue" onclick="consultarAPI()">Consultar</button>
        <button type="button" class="button-red" onclick="cancelarFormulario()">Cancelar</button>
      </div>
    </section>
    
    <div id="mensagem" class="mensagem-section hidden" role="alert"></div>

    <section id="formulario-mim" class="form-section hidden">
      <form id="formMim" onsubmit="event.preventDefault(); salvarFormulario();">
        <fieldset>
          <legend>Fale mais sobre voc√™</legend>
          <label for="nome1" class="required">Nome:</label> <input id="nome1" type="text" required>
          <label for="social1">Nome Social:</label> <input id="social1" type="text">
          <label for="genero1">G√™nero:</label>
          <select id="genero1">
            <option value="">Selecione</option>
            <option>Masculino</option>
            <option>Feminino</option>
            <option>N√£o Bin√°rio</option>
            <option>Outro</option>
            <option>Prefiro n√£o informar</option>
          </select>
          <label for="nasc1">Data de Nascimento:</label> <input type="date" id="nasc1">
          <button type="button" class="button-blue" style="margin: 15px 0;">üìç Usar minha localiza√ß√£o</button>
          <label for="municipio1" class="required">Munic√≠pio:</label> <input id="municipio1" placeholder="Digite ou selecione um munic√≠pio" required>
          <label for="endereco1">Endere√ßo:</label> <input type="text" id="endereco1">
          <label class="required">Situa√ß√£o de Rua?</label>
          <div class="radio-group">
            <label><input type="radio" name="situacaoRua" value="sim" required> Sim</label>
            <label><input type="radio" name="situacaoRua" value="nao"> N√£o</label>
          </div>
          <label class="required">Voc√™ √© brasileiro(a)?</label>
          <div class="radio-group">
            <label><input type="radio" name="brasileiroMim" value="sim" required> Sim</label>
            <label><input type="radio" name="brasileiroMim" value="nao"> N√£o</label>
          </div>
        </fieldset>
        <div class="button-group">
          <button type="submit" class="button-blue">Enviar</button>
          <button type="button" class="button-red" onclick="cancelarFormulario()">Cancelar</button>
        </div>
      </form>
    </section>

    <section id="formulario-alguem" class="form-section hidden">
       <form id="formAlguem" onsubmit="event.preventDefault(); salvarFormulario();">
        <fieldset>
          <legend>Voc√™ est√° ajudando como:</legend>
          <div class="radio-group">
            <label><input type="radio" name="tipoPerfil" value="cidadao_amigo" required> Cidad√£o Amigo</label>
            <label><input type="radio" name="tipoPerfil" value="profissional"> Profissional</label>
          </div>
        </fieldset>
        <fieldset>
          <legend>Fale mais sobre quem voc√™ est√° ajudando</legend>
          <label for="nome2" class="required">Nome completo de quem voc√™ est√° ajudando:</label> <input id="nome2" type="text" required>
          <label for="social2">Nome Social de quem voc√™ est√° ajudando:</label> <input id="social2" type="text">
          <label for="genero2">G√™nero de quem voc√™ est√° ajudando:</label>
          <select id="genero2">
            <option value="">Selecione</option>
            <option>Masculino</option>
            <option>Feminino</option>
            <option>N√£o Bin√°rio</option>
            <option>Outro</option>
            <option>Prefiro n√£o informar</option>
          </select>
          <label for="nasc2">Data de Nascimento de quem voc√™ est√° ajudando:</label> <input type="date" id="nasc2">
          <button type="button" class="button-blue" style="margin: 15px 0;">üìç Usar minha localiza√ß√£o</button>
          <label for="municipio2" class="required">Munic√≠pio de quem voc√™ est√° ajudando:</label> <input id="municipio2" placeholder="Digite ou selecione um munic√≠pio" required>
          <label for="endereco2">Endere√ßo de quem voc√™ est√° ajudando:</label> <input type="text" id="endereco2">
          <label class="required">Situa√ß√£o de Rua?</label>
          <div class="radio-group">
            <label><input type="radio" name="situacaoRua2" value="sim" required> Sim</label>
            <label><input type="radio" name="situacaoRua2" value="nao"> N√£o</label>
          </div>
          <label class="required">A pessoa que voc√™ est√° ajudando √© brasileira?</label>
          <div class="radio-group">
            <label><input type="radio" name="brasileiroAlguem" value="sim" required> Sim</label>
            <label><input type="radio" name="brasileiroAlguem" value="nao"> N√£o</label>
          </div>
        </fieldset>
        <div class="button-group">
          <button type="submit" class="button-blue">Enviar</button>
          <button type="button" class="button-red" onclick="cancelarFormulario()">Cancelar</button>
        </div>
      </form>
    </section>

  </main>

  <script>
    let perfilSelecionado = '';
    const mensagemDiv = document.getElementById('mensagem');
    const todosOsPaineis = ['avisoPrivacidadeModal', 'confirmacaoModal', 'consulta', 'mensagem', 'formulario-mim', 'formulario-alguem'];

    function selecionarOpcao(opcao) {
      perfilSelecionado = opcao;
      document.getElementById('avisoPrivacidadeModal').classList.remove('hidden');
    }

    function mostrarPopupConfirmacao() {
      document.getElementById('avisoPrivacidadeModal').classList.add('hidden');
      document.getElementById('confirmacaoModal').classList.remove('hidden');
    }

    function voltarParaAvisoPrivacidade() {
      document.getElementById('confirmacaoModal').classList.add('hidden');
      document.getElementById('avisoPrivacidadeModal').classList.remove('hidden');
    }

    function prosseguirParaConsulta() {
      const aceitou = document.getElementById('checkboxConfirmacao').checked;
      console.log(`Log de consentimento: O usu√°rio marcou a caixa de aceite? ${aceitou}`);
      document.getElementById('confirmacaoModal').classList.add('hidden');
      document.getElementById('consulta').classList.remove('hidden');
    }

    function cancelarFormulario() {
      todosOsPaineis.forEach(id => document.getElementById(id).classList.add('hidden'));
      perfilSelecionado = '';
      window.speechSynthesis.cancel();
    }

    function abrirPdf(url) {
        window.open(url, '_blank');
    }

    function consultarAPI() {
        const cpf = document.getElementById('cpf').value;
        const nis = document.getElementById('nis').value;
        document.getElementById('consulta').classList.add('hidden');

        if (cpf || nis) {
            exibirResultadoPositivo();
        } else {
            exibirFormularioTriagem();
        }
    }
    
    function exibirFormularioTriagem() {
        mensagemDiv.innerHTML = `
            <h4>N√£o encontramos seu cadastro no Cad√önico.</h4>
            <p>Para te ajudar a encontrar os servi√ßos mais pr√≥ximos, por favor, preencha algumas informa√ß√µes abaixo.</p>
        `;
        mensagemDiv.classList.remove('hidden');
        
        if (perfilSelecionado === 'mim') {
            document.getElementById('formulario-mim').classList.remove('hidden');
        } else {
            document.getElementById('formulario-alguem').classList.remove('hidden');
        }
    }

    function salvarFormulario() {
        document.getElementById('formulario-mim').classList.add('hidden');
        document.getElementById('formulario-alguem').classList.add('hidden');
        
        const situacaoRua = document.querySelector('input[name="situacaoRua"]:checked')?.value || document.querySelector('input[name="situacaoRua2"]:checked')?.value;
        
        let htmlResult = `<h4>Voc√™ ainda n√£o est√° no Cad√önico, mas pode buscar apoio.</h4>`;
        const definicoesMostradas = new Set();
        
        const servicoCras = { tipo: 'CRAS', nome: 'CRAS - Afogados', endereco: 'Rua 21 de Abril, 1092', pontoRef: 'Perto da padaria', contato: '(81) 3355-3671', codIbge: '2611606' };
        const servicoCreas = { tipo: 'CREAS', nome: 'CREAS - Centro', endereco: 'Rua do Sol, 100', pontoRef: 'Ao lado do teatro', contato: '(81) 3355-3000', codIbge: '2611606' };
        const servicoCozinha = { tipo: 'COZINHA', nome: 'Cozinha Comunit√°ria - Gurup√©', endereco: 'Rua Gurup√©, 253', representante: 'Nivea Gouveia', contato: '(81) 99362-9916', codIbge: '2611606' };

        if (situacaoRua === 'nao') {
            htmlResult += `<p>Dirija-se ao <strong>CRAS</strong> mais pr√≥ximo para se cadastrar e receber acompanhamento:</p>`;
            htmlResult += criarCardServico(servicoCras);
            htmlResult += getDefinicaoServicoUnicaVez(servicoCras.tipo, definicoesMostradas);
        } else {
            htmlResult += `<p>Dirija-se ao <strong>CREAS</strong> para receber acompanhamento especializado:</p>`;
            htmlResult += criarCardServico(servicoCreas);
            htmlResult += getDefinicaoServicoUnicaVez(servicoCreas.tipo, definicoesMostradas);
        }

        htmlResult += `<p>Voc√™ tamb√©m pode procurar uma <strong>Cozinha Comunit√°ria</strong>:</p>`;
        htmlResult += criarCardServico(servicoCozinha);
        htmlResult += getDefinicaoServicoUnicaVez(servicoCozinha.tipo, definicoesMostradas);

        // Adiciona o bot√£o Fechar
        htmlResult += `<div class="button-group" style="margin-top: 20px;"><button type="button" class="button-red" onclick="cancelarFormulario()">Fechar</button></div>`;

        mensagemDiv.innerHTML = htmlResult;
        mensagemDiv.classList.remove('hidden');
    }
    
    function exibirResultadoPositivo() {
        let htmlResult = `
            <h3>Voc√™ est√° cadastrado no Cad√önico.</h3>
            <div class="warning-block">
                <p><strong>‚ö†Ô∏è Voc√™ pode ter direito aos seguintes servi√ßos:</strong></p>
                <ul>
                    <li>Bolsa Fam√≠lia</li>
                    <li>M√£es de Pernambuco (<a href="http://www.maesdepernambuco.pe.gov.br" target="_blank">www.maesdepernambuco.pe.gov.br</a>)</li>
                </ul>
                <p><strong>Para confirmar sua elegibilidade e receber orienta√ß√µes, procure o CRAS mais pr√≥ximo.</strong></p>
            </div>
        `;
        
        const definicoesMostradas = new Set();
        const servicos = [
            { tipo: 'CRAS', nome: 'CRAS - Bongi', endereco: 'Av. Gen San Martin, 1083 - Bongi', pontoRef: 'Pr√≥ximo ao Compaz Ariano Suassuna', contato: '(81) 3225-9440 | cras.bongi@recife.pe.gov.br', codIbge: '2611606' },
            { tipo: 'CREAS', nome: 'CREAS - Afogados', endereco: 'Rua 21 de Abril, 1092 - Afogados', pontoRef: 'Pr√≥ximo ao Mercado P√∫blico de Afogados', contato: '(81) 3355-3671 | creasafogados@recife.pe.gov.br', codIbge: '2611606' },
            { tipo: 'COZINHA', nome: 'Cozinha Comunit√°ria - Gurup√©', endereco: 'Rua Gurup√©, 253, Afogados', representante: 'Nivea Gouveia', contato: '(81) 99362-9916', codIbge: '2611606' },
            { tipo: 'CRAS', nome: 'CRAS - Ibura', endereco: 'Rua Rio Paje√∫, 432 - Ibura', pontoRef: 'Perto da escola', contato: '(81) 3355-1234', codIbge: '2611606' }
        ];

        servicos.forEach(servico => {
            htmlResult += criarCardServico(servico);
            htmlResult += getDefinicaoServicoUnicaVez(servico.tipo, definicoesMostradas);
        });
        
        // Adiciona o bot√£o Fechar
        htmlResult += `<div class="button-group" style="margin-top: 20px;"><button type="button" class="button-red" onclick="cancelarFormulario()">Fechar</button></div>`;

        mensagemDiv.innerHTML = htmlResult;
        mensagemDiv.classList.remove('hidden');
    }

    function criarCardServico(servico) {
        const detalhesPorTipo = {
            'CRAS': `<li><strong>Endere√ßo:</strong> ${servico.endereco}</li><li><strong>Ponto de Refer√™ncia:</strong> ${servico.pontoRef}</li><li><strong>Contato:</strong> ${servico.contato}</li><li><strong>C√≥d. IBGE do Munic√≠pio:</strong> ${servico.codIbge}</li>`,
            'CREAS': `<li><strong>Endere√ßo:</strong> ${servico.endereco}</li><li><strong>Ponto de Refer√™ncia:</strong> ${servico.pontoRef}</li><li><strong>Contato:</strong> ${servico.contato}</li><li><strong>C√≥d. IBGE do Munic√≠pio:</strong> ${servico.codIbge}</li>`,
            'COZINHA': `<li><strong>Representante:</strong> ${servico.representante}</li><li><strong>Endere√ßo:</strong> ${servico.endereco}</li><li><strong>Telefone:</strong> ${servico.contato}</li><li><strong>C√≥d. IBGE do Munic√≠pio:</strong> ${servico.codIbge}</li>`
        };
        const classeCor = `${servico.tipo.toLowerCase()}-card`;
        
        return `
            <div class="service-card ${classeCor}">
                <h4>${servico.nome}</h4>
                <ul>${detalhesPorTipo[servico.tipo] || ''}</ul>
            </div>
        `;
    }

    function getDefinicaoServicoUnicaVez(tipo, definicoesMostradas) {
        if (definicoesMostradas.has(tipo)) return '';
        
        const definicoes = {
            'CRAS': '*CRAS √© o Centro de Refer√™ncia de Assist√™ncia Social. Ele √© a porta de entrada para os servi√ßos de prote√ß√£o social b√°sica...',
            'CREAS': '*CREAS √© o Centro de Refer√™ncia Especializado de Assist√™ncia Social. Atende fam√≠lias e indiv√≠duos com direitos violados...',
            'COZINHA': '**As Cozinhas Comunit√°rias oferecem refei√ß√µes prontas e saud√°veis, gratuitas ou a baixo custo...'
        };
        
        if (definicoes[tipo]) {
            definicoesMostradas.add(tipo);
            return `<div class="service-definition">${definicoes[tipo]}</div>`;
        }
        return '';
    }

    const readAloudBtn = document.getElementById('readAloudBtn');
    readAloudBtn.addEventListener('click', () => {
        const synth = window.speechSynthesis;
        if (synth.speaking) {
            synth.cancel();
            return;
        }
        const textoCompleto = document.querySelector('#avisoPrivacidadeModal .modal-content').textContent;
        const utterThis = new SpeechSynthesisUtterance(textoCompleto);
        utterThis.lang = 'pt-BR';
        synth.speak(utterThis);
    });
  </script>
</body>
</html>
